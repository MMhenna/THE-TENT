{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/mahdi/THE-TENT/components/main/Chat.js\";\n\nimport React, { useState, useEffect, useCallback, useLayoutEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { Bubble, GiftedChat, Send } from \"react-native-gifted-chat\";\nimport MaterialCommunityIcons from \"@expo/vector-icons/MaterialCommunityIcons\";\nimport FontAwesome from \"@expo/vector-icons/FontAwesome\";\nimport firebase from \"firebase\";\nimport { auth } from \"../../App\";\n\nvar ChatScreen = function ChatScreen() {\n  var _auth$currentUser, _auth$currentUser2, _auth$currentUser3;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      messages = _useState2[0],\n      oldMessages = _useState2[1];\n\n  var call = function call() {};\n\n  useEffect(function () {\n    try {\n      var _oldMessages = onSnapshot(firebase.firestore().collection('rooms').doc().collection('chats'), function (doc) {\n        console.log(\"Current data: \", doc.data());\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n\n  var _onSend = useCallback(function () {\n    var messages = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    oldMessages(function (previousMessages) {\n      return GiftedChat.append(previousMessages, messages);\n    });\n    var _messages$ = messages[0],\n        _id = _messages$._id,\n        createdAt = _messages$.createdAt,\n        text = _messages$.text,\n        user = _messages$.user;\n    firebase.firestore().collection(\"chats\").add({\n      _id: _id,\n      createdAt: createdAt,\n      text: text,\n      user: user\n    });\n  }, []);\n\n  var renderSend = function renderSend(props) {\n    return React.createElement(Send, _extends({}, props, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 7\n      }\n    }), React.createElement(View, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }\n    }, React.createElement(MaterialCommunityIcons, {\n      name: \"send-circle\",\n      style: {\n        marginBottom: 5,\n        marginRight: 5\n      },\n      size: 32,\n      color: \"#2e64e5\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }\n    })));\n  };\n\n  var renderBubble = function renderBubble(props) {\n    return React.createElement(Bubble, _extends({}, props, {\n      wrapperStyle: {\n        right: {\n          backgroundColor: \"#2e64e5\"\n        }\n      },\n      textStyle: {\n        right: {\n          color: \"#fff\"\n        }\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 7\n      }\n    }));\n  };\n\n  var scrollToBottomComponent = function scrollToBottomComponent() {\n    return React.createElement(FontAwesome, {\n      name: \"angle-double-down\",\n      size: 22,\n      color: \"#333\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 12\n      }\n    });\n  };\n\n  return React.createElement(GiftedChat, {\n    messages: messages,\n    onSend: function onSend(messages) {\n      return _onSend(messages);\n    },\n    user: {\n      _id: auth == null ? void 0 : (_auth$currentUser = auth.currentUser) == null ? void 0 : _auth$currentUser.email,\n      name: auth == null ? void 0 : (_auth$currentUser2 = auth.currentUser) == null ? void 0 : _auth$currentUser2.name,\n      avatar: auth == null ? void 0 : (_auth$currentUser3 = auth.currentUser) == null ? void 0 : _auth$currentUser3.photoURL\n    },\n    renderBubble: renderBubble,\n    alwaysShowSend: true,\n    renderSend: renderSend,\n    scrollToBottom: true,\n    scrollToBottomComponent: scrollToBottomComponent,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 5\n    }\n  });\n};\n\nexport default ChatScreen;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  }\n});","map":{"version":3,"sources":["/home/mahdi/THE-TENT/components/main/Chat.js"],"names":["React","useState","useEffect","useCallback","useLayoutEffect","Bubble","GiftedChat","Send","MaterialCommunityIcons","FontAwesome","firebase","auth","ChatScreen","messages","oldMessages","call","onSnapshot","firestore","collection","doc","console","log","data","error","onSend","previousMessages","append","_id","createdAt","text","user","add","renderSend","props","marginBottom","marginRight","renderBubble","right","backgroundColor","color","scrollToBottomComponent","currentUser","email","name","avatar","photoURL","styles","StyleSheet","create","container","flex","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import React, {\n  useState,\n  useEffect,\n  useCallback,\n  useLayoutEffect,\n} from \"react\";\nimport { View, ScrollView, Text, Button, StyleSheet } from \"react-native\";\nimport { Bubble, GiftedChat, Send } from \"react-native-gifted-chat\";\nimport MaterialCommunityIcons from \"react-native-vector-icons/MaterialCommunityIcons\";\nimport FontAwesome from \"react-native-vector-icons/FontAwesome\";\nimport firebase from \"firebase\";\n\nimport { auth } from \"../../App\";\n\nconst ChatScreen = () => {\n  const [messages, oldMessages] = useState([]);\n\n  // useEffect(() => {\n  //   setMessages([\n  //     {\n  //       _id: 1,\n  //       text: \"Hello developer\",\n  //       createdAt: new Date(),\n  //       user: {\n  //         _id: 2,\n  //         name: \"React Native\",\n  //         avatar: \"https://placeimg.com/140/140/any\",\n  //       },\n  //     },\n  //     {\n  //       _id: 2,\n  //       text: \"Hello world\",\n  //       createdAt: new Date(),\n  //       user: {\n  //         _id: 1,\n  //         name: \"React Native\",\n  //         avatar: \"https://placeimg.com/140/140/any\",\n  //       },\n  //     },\n  //   ]);\n  // }, []);\n  let call = () => {};\n\n  useEffect(() => {\n    try {\n      const oldMessages = onSnapshot(\n        firebase.firestore().collection('rooms').doc().collection('chats'),\n        (doc) => {\n          console.log(\"Current data: \", doc.data());\n        }\n      );\n      // const unsubscribe = await firebase\n      //   .firestore()\n      //   .collection(\"chats\")\n      //   .orderBy(\"createdAt\", \"desc\")\n      //   .get()\n      //   .onSnapshot( (snapshot) => {\n\n      //     console.log(snapshot);\n\n      //   }\n      // setMessages(\n      //   snapshot.docs.maps((doc) => ({\n      //     _id: doc.data()._id,\n      //     createdAt: doc.data().createdAt.toDate(),\n      //     text: doc.data().text,\n      //     user: doc.data().user,\n      //   }))\n      // )\n      // );\n    } catch (error) {\n      console.log(error);\n    }\n  });\n\n  const onSend = useCallback((messages = []) => {\n    oldMessages((previousMessages) =>\n      GiftedChat.append(previousMessages, messages)\n    );\n    const { _id, createdAt, text, user } = messages[0];\n    firebase\n      .firestore()\n      .collection(\"chats\")\n      .add({ _id, createdAt, text, user });\n  }, []);\n\n  const renderSend = (props) => {\n    return (\n      <Send {...props}>\n        <View>\n          <MaterialCommunityIcons\n            name=\"send-circle\"\n            style={{ marginBottom: 5, marginRight: 5 }}\n            size={32}\n            color=\"#2e64e5\"\n          />\n        </View>\n      </Send>\n    );\n  };\n\n  const renderBubble = (props) => {\n    return (\n      <Bubble\n        {...props}\n        wrapperStyle={{\n          right: {\n            backgroundColor: \"#2e64e5\",\n          },\n        }}\n        textStyle={{\n          right: {\n            color: \"#fff\",\n          },\n        }}\n      />\n    );\n  };\n\n  const scrollToBottomComponent = () => {\n    return <FontAwesome name=\"angle-double-down\" size={22} color=\"#333\" />;\n  };\n\n  return (\n    <GiftedChat\n      messages={messages}\n      onSend={(messages) => onSend(messages)}\n      user={{\n        _id: auth?.currentUser?.email,\n        name: auth?.currentUser?.name,\n        avatar: auth?.currentUser?.photoURL,\n      }}\n      renderBubble={renderBubble}\n      alwaysShowSend\n      renderSend={renderSend}\n      scrollToBottom\n      scrollToBottomComponent={scrollToBottomComponent}\n    />\n  );\n};\n\nexport default ChatScreen;\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n"]},"metadata":{},"sourceType":"module"}